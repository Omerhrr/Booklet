
<tr id="product-row-{{ product.id }}">
    <td class="px-4 py-3 text-sm font-medium text-gray-900 dark:text-white">
        <a href="/inventory/products/{{ product.id }}/view" class="text-blue-600 dark:text-blue-400 hover:underline">
            {{ product.name }}
        </a>
    </td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ product.sku or 'N/A' }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ product.category.name }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ product.unit or '' }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ "%.2f"|format(product.purchase_price) }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ "%.2f"|format(product.sales_price) }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">{{ product.opening_stock }}</td>
    <td class="px-4 py-3 text-sm text-gray-500 dark:text-gray-400">
            <div class="flex items-center space-x-2">
            <div class="flex items-center space-x-2">
        {# --- THIS IS THE FIX --- #}
        <span>{{ product.stock_quantity }} </span>
            {% if 'inventory:adjust_stock' in user_perms %}
            {# --- THIS IS THE NEW, SIMPLER BUTTON --- #}
            <button 
                hx-get="/inventory/products/{{ product.id }}/adjust-stock-form"
                hx-target="#product-row-{{ product.id }}"
                hx-swap="outerHTML"
                class="p-1 text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300" 
                title="Adjust Stock">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
            </button>
            {% endif %}
        </div>
    </td>
    <td class="px-4 py-3 whitespace-nowrap text-right text-sm font-medium space-x-2">
        <button hx-get="/inventory/products/{{ product.id }}/edit" hx-target="#product-row-{{ product.id }}" hx-swap="outerHTML"
                class="text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300">
            Edit
        </button>
        <button hx-delete="/inventory/products/{{ product.id }}" hx-target="#product-row-{{ product.id }}" hx-swap="delete"
                hx-confirm="Are you sure you want to delete this product?"
                class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300">
            Delete
        </button>
    </td>
</tr>

